Task: Add a keyframe-based animation timeline and playback system with interpolation, scrubbing, and a persistent bottom bar containing animation toggles/settings and a control to open/close the timeline panel.

Functional Requirements:
- Timeline and Play
  - Global playhead, FPS, in/out range, zoom/pan, frame ruler.
  - Transport: Play/Pause, Stop, Loop, Seek to start/end, Prev/Next keyframe.
  - Scrubbing updates state deterministically from time t.
- Bottom Bar (new)
  - Full-width, fixed to bottom, black bar; 40–56px height; always visible in the editor.
  - Contains quick animation controls: Play/Pause, Stop, Loop, Auto-key toggle, FPS selector, timecode display, range in/out, and a “Timeline Panel” toggle (open/close).
  - Non-intrusive overlay above the viewport; does not obstruct interactions when not hovered; keyboard-accessible.
  - Reflects current animation state (playing, loop, auto-key, current clip/time); disabled states when no clip.
- Keyframes and Tracks
  - Keyframe any animatable property across scene, geometry, viewport, and world stores; tracks per property path; scalar/vector channels.
  - Interpolation: step, linear, bezier; editable handles and snapping.
  - Operations: insert/delete/move/scale/copy/paste keys, box select; auto-key on edit toggle.
- Clips and Markers
  - MVP: single active clip; start/end, loop, speed; global markers lane.
- Filtering and Selection
  - Track list grouped by target; filter by selected objects/type/search; mute/solo/lock tracks.
- Runtime Application
  - Sample at time t and apply via store actions only; handle missing/renamed targets gracefully.
- Persistence and I/O
  - Save/load animations with project; T3D import/export extensions.
- Performance
  - Smooth 60fps scrubbing/playback; sorted keys, cached curves; minimal GC; batched state updates.

User Interactions:
- Bottom Bar
  - Click Play/Pause/Stop/Loop; toggle Auto-key; change FPS; see timecode; set in/out; toggle “Open Timeline.”
  - Keyboard: Space (Play/Pause), Shift+Space (Stop), Home/End (Seek to in/out), L (toggle loop), K (toggle auto-key), T (toggle timeline panel).
  - Hover tooltips; clear disabled states when no clip.
- Timeline UI
  - Pan/zoom; click/drag to scrub; drag keys; edit bezier handles; marquee select; snapping toggle.
  - Context menu for interpolation/easing/mute/solo/lock/copy/paste.
  - Right-click on any property control → Insert/Remove Keyframe, Interpolation…
- Property Binding
  - Auto-key inserts/updates keys from property edits at playhead; indicators shown next to animatable controls.

Data Requirements:
- Animation data
  - clips[], activeClipId, playhead, playing, fps, loop, autoKey, in/out range, selection.
  - tracks[] with target ref and property path; channels[] with keys[].
- Bottom bar state
  - timelinePanelOpen: boolean; barVisible: boolean (always true in MVP); compact mode thresholds; lastUsedFps, lastUsedClipId.
- Sources/Sinks
  - IDs from scene-store (objects/lights), geometry-store (materials/cameras/modifierStacks), viewport-store (camera/activeCamera), world-store.
  - Persist animations and UI prefs (timeline open, fps) to T3D and local storage (draft).

State Management:
- Global (new animation-store)
  - clips, tracks, keys, playhead, playing, fps, loop, autoKey, in/out, selection, timelinePanelOpen.
  - Caches: per-track sorted times and bezier coeffs; invalidated on edits.
  - Single RAF-driven sampler in the Canvas frame to advance and apply batched updates.
- Local/UI
  - Timeline component holds pan/zoom/hover/drag; bottom bar is stateless except reading/writing animation-store.
- Persistence
  - Extend T3D schema with animations and minimal UI prefs (timelinePanelOpen, fps); autosave drafts locally.

Notes:
- Integration points
  - Add `src/stores/animation-store.ts`.
  - Add `src/features/animation/components/BottomBar.tsx` (fixed bottom black bar), `Timeline.tsx`, `Transport.tsx`.
  - Mount BottomBar at app root (e.g., in layout.tsx) so it overlays the editor; ensure Canvas container leaves it unobstructed or bar uses pointer-events intelligently.
  - Add `<AnimationSampler />` under `Canvas` to run on the same RAF; pause auto-orbit while playing.
- UX details
  - Black bar styling: full-width, z-index above viewport, subtle shadow/top border, keyboard focus ring, high-contrast icons/text.
  - Compact mode when viewport height is small; collapse text labels into icons; overflow menu for extras.
- MVP first
  - Bottom bar with Play/Pause/Stop/Loop/Auto-key/FPS/timecode/in-out and Timeline toggle.
  - One clip; transform tracks (position/rotation/scale); step/linear; T3D save/load.
  - Follow-ups: bezier, materials/lights/modifiers/world params, markers, track mute/solo, copy/paste, easing presets.