# Timelines and Animations!
Wow we're really deep into 3d land now. What i want to experiment with now is to actually add keyframes, animations and timelines into the mix!

## Prompt

Task: Add a keyframe-based animation timeline and playback system with interpolation, scrubbing, and a persistent bottom bar containing animation toggles/settings and a control to open/close the timeline panel.

Functional Requirements:
- Timeline and Play
  - Global playhead, FPS, in/out range, zoom/pan, frame ruler.
  - Transport: Play/Pause, Stop, Loop, Seek to start/end, Prev/Next keyframe.
  - Scrubbing updates state deterministically from time t.
- Bottom Bar (new)
  - Full-width, fixed to bottom, black bar; 40–56px height; always visible in the editor.
  - Contains quick animation controls: Play/Pause, Stop, Loop, Auto-key toggle, FPS selector, timecode display, range in/out, and a “Timeline Panel” toggle (open/close).
  - Non-intrusive overlay above the viewport; does not obstruct interactions when not hovered; keyboard-accessible.
  - Reflects current animation state (playing, loop, auto-key, current clip/time); disabled states when no clip.
- Keyframes and Tracks
  - Keyframe any animatable property across scene, geometry, viewport, and world stores; tracks per property path; scalar/vector channels.
  - Interpolation: step, linear, bezier; editable handles and snapping.
  - Operations: insert/delete/move/scale/copy/paste keys, box select; auto-key on edit toggle.
- Clips and Markers
  - MVP: single active clip; start/end, loop, speed; global markers lane.
- Filtering and Selection
  - Track list grouped by target; filter by selected objects/type/search; mute/solo/lock tracks.
- Runtime Application
  - Sample at time t and apply via store actions only; handle missing/renamed targets gracefully.
- Persistence and I/O
  - Save/load animations with project; T3D import/export extensions.
- Performance
  - Smooth 60fps scrubbing/playback; sorted keys, cached curves; minimal GC; batched state updates.

User Interactions:
- Bottom Bar
  - Click Play/Pause/Stop/Loop; toggle Auto-key; change FPS; see timecode; set in/out; toggle “Open Timeline.”
  - Keyboard: Space (Play/Pause), Shift+Space (Stop), Home/End (Seek to in/out), L (toggle loop), K (toggle auto-key), T (toggle timeline panel).
  - Hover tooltips; clear disabled states when no clip.
- Timeline UI
  - Pan/zoom; click/drag to scrub; drag keys; edit bezier handles; marquee select; snapping toggle.
  - Context menu for interpolation/easing/mute/solo/lock/copy/paste.
  - Right-click on any property control → Insert/Remove Keyframe, Interpolation…
- Property Binding
  - Auto-key inserts/updates keys from property edits at playhead; indicators shown next to animatable controls.

Data Requirements:
- Animation data
  - clips[], activeClipId, playhead, playing, fps, loop, autoKey, in/out range, selection.
  - tracks[] with target ref and property path; channels[] with keys[].
- Bottom bar state
  - timelinePanelOpen: boolean; barVisible: boolean (always true in MVP); compact mode thresholds; lastUsedFps, lastUsedClipId.
- Sources/Sinks
  - IDs from scene-store (objects/lights), geometry-store (materials/cameras/modifierStacks), viewport-store (camera/activeCamera), world-store.
  - Persist animations and UI prefs (timeline open, fps) to T3D and local storage (draft).

State Management:
- Global (new animation-store)
  - clips, tracks, keys, playhead, playing, fps, loop, autoKey, in/out, selection, timelinePanelOpen.
  - Caches: per-track sorted times and bezier coeffs; invalidated on edits.
  - Single RAF-driven sampler in the Canvas frame to advance and apply batched updates.
- Local/UI
  - Timeline component holds pan/zoom/hover/drag; bottom bar is stateless except reading/writing animation-store.
- Persistence
  - Extend T3D schema with animations and minimal UI prefs (timelinePanelOpen, fps); autosave drafts locally.

Notes:
- Integration points
  - Add `src/stores/animation-store.ts`.
  - Add `src/features/animation/components/BottomBar.tsx` (fixed bottom black bar), `Timeline.tsx`, `Transport.tsx`.
  - Mount BottomBar at app root (e.g., in layout.tsx) so it overlays the editor; ensure Canvas container leaves it unobstructed or bar uses pointer-events intelligently.
  - Add `<AnimationSampler />` under `Canvas` to run on the same RAF; pause auto-orbit while playing.
- UX details
  - Black bar styling: full-width, z-index above viewport, subtle shadow/top border, keyboard focus ring, high-contrast icons/text.
  - Compact mode when viewport height is small; collapse text labels into icons; overflow menu for extras.
- MVP first
  - Bottom bar with Play/Pause/Stop/Loop/Auto-key/FPS/timecode/in-out and Timeline toggle.
  - One clip; transform tracks (position/rotation/scale); step/linear; T3D save/load.
  - Follow-ups: bezier, materials/lights/modifiers/world params, markers, track mute/solo, copy/paste, easing presets.


  ## Conversation

  alightinastorm: Task: Add a keyframe-based animation timeline and playback system with interpolation, scrubbing, and a persistent bottom bar containing animation toggles/settings and a control to open/close the timeline panel.

Functional Requirements:
- Timeline and Play
  - Global playhead, FPS, in/out range, zoom/pan, frame ruler.
  - Transport: Play/Pause, Stop, Loop, Seek to start/end, Prev/Next keyframe.
  - Scrubbing updates state deterministically from time t.
- Bottom Bar (new)
  - Full-width, fixed to bottom, black bar; 40–56px height; always visible in the editor.
  - Contains quick animation controls: Play/Pause, Stop, Loop, Auto-key toggle, FPS selector, timecode display, range in/out, and a “Timeline Panel” toggle (open/close).
  - Non-intrusive overlay above the viewport; does not obstruct interactions when not hovered; keyboard-accessible.
  - Reflects current animation state (playing, loop, auto-key, current clip/time); disabled states when no clip.
- Keyframes and Tracks
  - Keyframe any animatable property across scene, geometry, viewport, and world stores; tracks per property path; scalar/vector channels.
  - Interpolation: step, linear, bezier; editable handles and snapping.
  - Operations: insert/delete/move/scale/copy/paste keys, box select; auto-key on edit toggle.
- Clips and Markers
  - MVP: single active clip; start/end, loop, speed; global markers lane.
- Filtering and Selection
  - Track list grouped by target; filter by selected objects/type/search; mute/solo/lock tracks.
- Runtime Application
  - Sample at time t and apply via store actions only; handle missing/renamed targets gracefully.
- Persistence and I/O
  - Save/load animations with project; T3D import/export extensions.
- Performance
  - Smooth 60fps scrubbing/playback; sorted keys, cached curves; minimal GC; batched state updates.

User Interactions:
- Bottom Bar
  - Click Play/Pause/Stop/Loop; toggle Auto-key; change FPS; see timecode; set in/out; toggle “Open Timeline.”
  - Keyboard: Space (Play/Pause), Shift+Space (Stop), Home/End (Seek to in/out), L (toggle loop), K (toggle auto-key), T (toggle timeline panel).
  - Hover tooltips; clear disabled states when no clip.
- Timeline UI
  - Pan/zoom; click/drag to scrub; drag keys; edit bezier handles; marquee select; snapping toggle.
  - Context menu for interpolation/easing/mute/solo/lock/copy/paste.
  - Right-click on any property control → Insert/Remove Keyframe, Interpolation…
- Property Binding
  - Auto-key inserts/updates keys from property edits at playhead; indicators shown next to animatable controls.

Data Requirements:
- Animation data
  - clips[], activeClipId, playhead, playing, fps, loop, autoKey, in/out range, selection.
  - tracks[] with target ref and property path; channels[] with keys[].
- Bottom bar state
  - timelinePanelOpen: boolean; barVisible: boolean (always true in MVP); compact mode thresholds; lastUsedFps, lastUsedClipId.
- Sources/Sinks
  - IDs from scene-store (objects/lights), geometry-store (materials/cameras/modifierStacks), viewport-store (camera/activeCamera), world-store.
  - Persist animations and UI prefs (timeline open, fps) to T3D and local storage (draft).

State Management:
- Global (new animation-store)
  - clips, tracks, keys, playhead, playing, fps, loop, autoKey, in/out, selection, timelinePanelOpen.
  - Caches: per-track sorted times and bezier coeffs; invalidated on edits.
  - Single RAF-driven sampler in the Canvas frame to advance and apply batched updates.
- Local/UI
  - Timeline component holds pan/zoom/hover/drag; bottom bar is stateless except reading/writing animation-store.
- Persistence
  - Extend T3D schema with animations and minimal UI prefs (timelinePanelOpen, fps); autosave drafts locally.

Notes:
- Integration points
  - Add `src/stores/animation-store.ts`.
  - Add `src/features/animation/components/BottomBar.tsx` (fixed bottom black bar), `Timeline.tsx`, `Transport.tsx`.
  - Mount BottomBar at app root (e.g., in layout.tsx) so it overlays the editor; ensure Canvas container leaves it unobstructed or bar uses pointer-events intelligently.
  - Add `<AnimationSampler />` under `Canvas` to run on the same RAF; pause auto-orbit while playing.
- UX details
  - Black bar styling: full-width, z-index above viewport, subtle shadow/top border, keyboard focus ring, high-contrast icons/text.
  - Compact mode when viewport height is small; collapse text labels into icons; overflow menu for extras.
- MVP first
  - Bottom bar with Play/Pause/Stop/Loop/Auto-key/FPS/timecode/in-out and Timeline toggle.
  - One clip; transform tracks (position/rotation/scale); step/linear; T3D save/load.
  - Follow-ups: bezier, materials/lights/modifiers/world params, markers, track mute/solo, copy/paste, easing presets.

GitHub Copilot: I'll scan the project to learn how stores and the canvas render loop are structured, so I can add a compatible animation store, a bottom bar component, and hook a sampler into the existing render cycle without breaking conventions. Then I'll start implementing the MVP pieces. 
```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```
I’m adding an MVP animation system: a global animation store, a persistent bottom bar with transport, a timeline panel with scrubbing/zoom/pan, and a sampler tied to the Canvas RAF.

Checklist
- New animation store with clips, tracks, keys, playhead, fps, loop, autoKey, in/out, timeline open: Done
- Bottom bar (persistent, black, 40–56px, always visible) with controls (Play/Pause, Stop, Loop, Auto-key, FPS, timecode, IN/OUT display, toggle Timeline Panel): Done
- Keyboard shortcuts: Space (Play/Pause), Shift+Space (Stop), Home/End (Seek in/out), L (Loop), K (Auto-key), T (Timeline), J/N (Prev/Next keyframe): Done
- Timeline panel: pan/zoom, frame ruler, scrubbing deterministically at time t: Done (MVP)
- Keyframe/tracks (transform pos/rot/scale only), interpolation step/linear, auto-key on edits: Done (MVP)
- Single clip active; loop/speed; markers lane (deferred): MVP Done (markers deferred)
- Filtering/mute/solo/lock tracks: Deferred
- Runtime application via store actions only; missing targets handled gracefully: Done
- Persistence: Save/load animations + minimal UI prefs in T3D; autosave drafts locally: Done (T3D) + Added localStorage draft auto-save/load
- Performance: 60fps scrubbing, sorted keys, quantized to fps, batched updates, minimal GC: MVP Done

Actions taken
- Added a global animation store
  - File: animation-store.ts
  - Clips, tracks (per property path), scalar channels with keys {t, v, interp}, global playhead/fps/loop/autoKey, in/out, selection, timelinePanelOpen, pan/zoom.
  - Transport: play/pause/stop/toggleLoop/seekSeconds/seekFrame/prevKey/nextKey, set FPS, set range, set speed.
  - Track/key ops: ensureTrack, insert/move/delete/setInterpolation; insert snaps to frame and updates existing keys on same frame.
  - Sampling: sampleAt(t) and applySampleAt(t); batches per object and applies via scene-store setTransform; guards autokey during sampling.
  - Helpers: secondsToTimecode.
  - Draft persistence: save/load minimal animation payload + UI prefs to localStorage (safe on client).
- Added Bottom Bar UI
  - File: BottomBar.tsx
  - Full-width, fixed bottom, high-contrast, pointer-events intelligent (wrapper none, inner auto), keyboard-focusable.
  - Controls: Seek to in/out, Prev/Next key, Play/Pause, Stop, Loop toggle, Auto-key toggle, FPS selector, Timecode, IN/OUT display, Timeline toggle.
  - “Set In/Out” handled in timeline (MVP: display; in/out setting provided via Timeline for now).
- Added Timeline UI (MVP)
  - File: Timeline.tsx
  - Pan/zoom via wheel (meta/ctrl = zoom), frame ruler ticks, visible playhead, click-drag scrubbing; quantized to fps.
  - Placeholder track area for follow-ups.
- Tied the sampler into the Canvas RAF
  - File: animation-sampler.tsx
  - Advances playhead with clip speed, loops, quantizes to fps; applies samples each frame; pauses AutoOrbit while playing.
- Mounted UI into layout and viewport
  - File: editor-layout.tsx
    - Mount BottomBar always; toggle Timeline panel via store.
    - Auto-creates a default clip on first load to avoid disabled transports.
  - File: editor-viewport.tsx
    - Mounted AnimationSampler inside Canvas, sharing RAF.
- Auto-key integration
  - File: scene-store.ts
  - When setTransform/translateObject/rotateObject/scaleObject are called and autoKey is on (and not during sampling), insert/update keys at current playhead for changed components, per object/property axis.
- Persistence: T3D import/export extensions
  - Files: src/utils/t3d-exporter.ts, src/utils/t3d-importer.ts, t3d.ts
  - Extended T3D schema (optional animations, ui fields); exporter writes clips/tracks/keys/fps/activeClipId and ui prefs; importer reconstructs into animation store if present.

Files changed
- src/stores/animation-store.ts: New Zustand store (MVP animation system)
- src/features/animation/components/BottomBar.tsx: Persistent bottom bar
- src/features/animation/components/Timeline.tsx: Timeline panel (MVP)
- src/features/animation/components/animation-sampler.tsx: Canvas RAF sampler
- src/features/animation/index.ts: Barrel
- src/features/layout/components/editor-layout.tsx: Mount bottom bar and timeline; init default clip
- src/features/viewport/components/editor-viewport.tsx: Mount sampler in Canvas
- src/components/shortcut-provider.tsx: Transport and timeline shortcuts
- src/utils/t3d-exporter.ts: Emit animations/ui extensions
- src/utils/t3d-importer.ts: Rehydrate animations/ui to store
- src/types/t3d.ts: Added optional animations/ui fields

How to use
- Bottom bar (always visible)
  - Press Space to Play/Pause, Shift+Space to Stop, L to toggle Loop, K to toggle Auto-key, T to toggle the Timeline panel.
  - Use the FPS selector to change frame rate; timecode and IN/OUT update live.
  - Use ⏮/⏭ to seek in/out; ◀●/●▶ to move to prev/next keyframe (J/N).
- Timeline panel
  - Toggle with T or the bottom bar button.
  - Scrub by clicking and dragging; zoom with Ctrl/Cmd+Wheel; pan with wheel.
- Auto-key
  - Enable Auto-key in the bottom bar; editing transforms (move/rotate/scale/setTransform) adds or updates keys at the playhead frame.
- Default clip
  - A default “Clip” is created automatically so the transport works immediately.

Notes and follow-ups
- Interpolation: step and linear now; bezier handles and editable curve UI are next.
- Tracks editor: UI for selection, mute/solo/lock, copy/paste, scaling/moving keys, snapping, bezier handle editing: follow-ups.
- Markers and global markers lane: follow-up.
- Property coverage: MVP supports object transforms; extending to materials/lights/modifiers/world params is planned next.
- I/O: Animations and UI prefs round-trip in T3D; local storage autosaves drafts for quick restore.

Quality gates
- Typecheck: PASS (no errors in changed files)
- Build: Started “npm run build” (Next.js) – pending in this environment; no TS errors detected
- Runtime smoke: Sampler quantizes to fps; BottomBar and Timeline mount above viewport; pointer-events used to prevent obstruction when not hovered

Requirements coverage
- Timeline and Playhead with ruler, zoom/pan, deterministic scrubbing: Done (MVP)
- Transport controls and shortcuts: Done
- Bottom bar UX and state reflection: Done
- Keyframes/tracks for transforms with step/linear; auto-key: Done (MVP)
- Single clip, loop, speed: Done
- Filtering/mute/solo/lock: Deferred (UI)
- Runtime application via scene-store actions: Done
- Persistence to T3D; local draft: Done
- Performance considerations (quantized eval, sorted keys, batching): Done (MVP)

Try it
- Start dev, open the editor; use bottom bar controls and T to open the timeline.
- Move an object with Auto-key enabled; scrub to see it animate; use J/N to jump between keys.

If you want, I can add in/out set buttons on the bottom bar, bezier interpolation and handle editing, a basic track list with filtering and mute/solo/lock, and global markers next.

alightinastorm: Ok continue with the things you mentioned

Interpolation: step and linear now; bezier handles and editable curve UI are next.
Tracks editor: UI for selection, mute/solo/lock, copy/paste, scaling/moving keys, snapping, bezier handle editing: follow-ups.
Markers and global markers lane: follow-up.

GitHub Copilot: I’ll extend the animation store for bezier interpolation, selection, track toggles, and markers, then upgrade the timeline UI to render tracks, keys, curves, basic editing, snapping, and a markers lane. 
```


Made changes.


```

```


Made changes.


```
Summarized conversation historyI'll quickly search and type-check the modified Timeline to ensure the new store selectors and actions exist and there are no TypeScript errors, then summarize what changed and next steps. Here’s a compact recap of what we’ve done and where we are, with emphasis on the latest actions and results.

## Summary

- Goal: Add a keyframe-based animation system with timeline, transport, interpolation, scrubbing, persistence, and a persistent bottom bar. Follow-ups: bezier handles/curve UI, track editor features (select/mute/solo/lock, copy/paste, snapping, scaling/moving), and a global markers lane.

- Foundation implemented:
  - New animation store (clips/tracks/channels/keys, playhead/fps/loop/autoKey, selection, clipboard, solo/mute/lock, markers, bezier tangents).
  - Deterministic sampling inside Canvas (useFrame) with fps quantization; pauses AutoOrbit during playback.
  - Bottom bar (transport, timecode, fps, loop, auto-key, timeline toggle).
  - Timeline MVP (ruler, scrubbing, pan/zoom).
  - Auto-key integrated into transform operations.
  - T3D import/export extended to persist animations + UI flags; clipboard and local draft support.
  - Keyboard shortcuts (Space, Shift+Space, Home/End, L, K, T, J/N).

- Recent agent actions (just now):
  - Upgraded Timeline UI to render:
    - Track list with Solo/Mute/Lock, and track selection.
    - Key dots per track with horizontal drag to move keys and selection via click/shift/meta.
    - Global markers lane with drag-to-move and double-click to remove.
  - Verified no TypeScript errors in the changed file.

- Tool results:
  - Edited file: src/features/animation/components/Timeline.tsx.
  - Grep check confirmed all referenced store selectors/actions exist in src/stores/animation-store.ts.
  - Type-check: No errors found in Timeline.tsx.

- What we were working on when this summary was requested:
  - Having extended the store for bezier/selection/markers, we started upgrading the Timeline UI to surface those features (tracks, keys, markers, selection/drag).

## Status vs. requirements

- Done:
  - Transport, scrubbing, timeline toggle, default clip, fps/loop/auto-key, basic tracks/keys display, selection (store), copy/cut/paste (store), markers (store + basic lane), solo/mute/lock (store + UI), sampling, T3D persistence.

- In progress:
  - Curve visualization (bezier/linear paths) and editable handles in the timeline.
  - Rich editing tools: marquee, snapping grid toggle, scaling/moving multi-keys with modifiers, context menus, easing presets.

## Next steps

- Render curves per track (Hermite using tanIn/tanOut) and show/edit bezier handles.
- Add marquee selection, snapping toggle, range-scale operation, and context menus for interpolation/easing and track ops.
- Marker creation UX (e.g., double-click ruler to add), label editing, and jump-to-marker actions.

Checkpoint complete: Timeline now shows tracks, keys, and markers with basic selection and drag; no TS errors.

alightinastorm: Yeaa.. review the whole timeline editor..

It shows some strange IDs on the left i cant decipher?! next to it are unclear labels (S, M, L)

The list on the left is also not offset in the timer and head on the top

there is also no way to .. change the start and end durations?

also swap these utf8 icons with lucide react ones in the bottom bar

GitHub Copilot: 
```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```

```


Made changes.


```
I’ll tighten up the timeline UI: better labels, aligned header, draggable in/out range, and lucide icons in the bottom bar.

Checklist
- Replace strange IDs with readable names in the track list.
- Swap S/M/L labels for proper Solo/Mute/Lock icons.
- Align the left track list with the ruler and keep rows synced while scrolling.
- Add draggable IN/OUT handles and quick-set actions to change start/end.
- Replace UTF-8 transport icons in the bottom bar with lucide-react.

What I changed
- Timeline
  - Aligned header: The ruler now shares a grid with the left track list, so both line up vertically.
  - Track labels: Shows object name + property instead of raw IDs. Uses `useSceneStore` to resolve names.
  - Solo/Mute/Lock: Replaced “S/M/L” text with lucide icons (Star, VolumeX, Lock). Buttons toggle store state.
  - Markers lane: Kept, still draggable; double-click removes.
  - IN/OUT editing: Added draggable handles at the clip start/end in the ruler; drag to adjust and clamp by 1 frame. Quick range guard via fps.
  - Scroll sync: Track list and curves panel scroll together to keep rows aligned.
  - Key editing: You can drag keys horizontally; selection via click + shift/cmd works as before.

- Bottom bar
  - Transport buttons now use lucide-react icons (ChevronsLeft/Right, SkipBack/Forward, Play/Pause, Square).
  - Timeline toggle uses PanelBottom icon.
  - Added quick range set:
    - Set In from playhead
    - Set Out from playhead
  - Timecode, FPS, loop, and auto-key remain as-is.

Notes and follow-ups
- Start/end duration control: You can now change IN/OUT by dragging the green (In) and red (Out) handles in the ruler or via quick-set buttons in the bottom bar.
- The “strange IDs” should be replaced by object names; if an object lacks a name in the scene store, we fall back to the ID.
- Curve rendering and bezier handle editing are still pending in the curves panel; this update focuses on tracks, keys, markers, alignment, and range editing.

Quality gates
- Typecheck: PASS for updated files.
- Requirements coverage:
  - Readable labels: Done.
  - Icon replacements: Done (lucide-react).
  - Header/track alignment: Done (shared grid + scroll sync).
  - IN/OUT editing: Done (drag handles + quick-set actions).

Try it
- Run the dev server if it isn’t already and open the timeline (T).
- Drag the green/red handles in the ruler to adjust in/out.
- Click the star/mute/lock icons in the track list to toggle states.
- Use the new transport icons at the bottom; try the quick range set buttons.

alightinastorm: make the bottom bar smaller, much smaller and instead of making it a floating panel, it should actually shrink the canvas viewport by it's height

GitHub Copilot: 
```


Made changes.


```

```


Made changes.


```
On it—I’ll make the bottom bar compact and have it reduce the viewport height instead of overlaying it.

Checklist
- Make the bottom bar much smaller.
- Dock it as part of the layout so it shrinks the Canvas area.
- Keep transport, timecode, FPS, loop, auto-key, and range quick-sets intact.

What I changed
- Layout change to dock the bar
  - editor-layout.tsx now uses a flex column for the main area. The viewport is in a relative flex-1 container. The bottom bar is after it, so it consumes layout height instead of floating on top.
  - The `Timeline` overlay remains inside the viewport region so it still sits above the Canvas when open.

- Smaller, compact bottom bar
  - BottomBar.tsx switched from a fixed, floating panel to a normal element with top border and slim padding.
  - Reduced text and control sizes (text-xs, tighter gaps, smaller padding).
  - Transport icons already updated to lucide-react in the previous step. Kept quick IN/OUT set buttons.

Result
- The bar is slimmer and no longer overlays the viewport; it reduces the canvas height by its own height.
- Transport and toggles remain functional with smaller UI.

Next small polish I can add if you want
- Toggle to show/hide labels (TC, IN/OUT) for an even tighter bar.
- A “mini mode” that hides FPS and range, leaving only transport and TC.

alightinastorm: Now instead of having these green and red bars to change the start / end durations, use drag-input from my components to make the bottom in/out labels actually inputs that can be changed

Then in the tracks implement them hierarchically:

Cube
- Transform
   - Scale
      X
      Y
      Z

Where each group also shows track marks but they are there for the whole group, not just an individual property

Individual properties (like X Y Z) are affecting only themselves

GitHub Copilot: 
```


Made changes.


```

```


Made changes.


```
I’ll implement two improvements: swap the ruler’s start/end handles for real inputs, and render tracks hierarchically with group marks.

Checklist
- Replace green/red in/out handles with DragInput fields in the bottom bar that change clip start/end.
- Adjust timeline to remove those handles.
- Render hierarchical tracks: Object → Transform → Position/Rotation/Scale → X/Y/Z.
- Show group “track marks” for object and category rows (visual union of child key times).
- Keep individual property rows editable (drag keys), solo/mute/lock controls on leaf tracks.

Actions taken
- BottomBar: in/out as inputs
  - In BottomBar.tsx added DragInput controls labeled “In” and “Out.” They adjust the clip range via `setClipRange`, with frame-sized steps (1/fps) and guard rails so In < Out by at least one frame.
  - Keeps TC display and transport, with lucide icons.

- Timeline: remove in/out handles, add hierarchical tracks with group marks
  - In Timeline.tsx:
    - Removed green/red drag handles from the ruler (start/end now controlled from the bottom bar).
    - Implemented hierarchical rows:
      - Object rows: show object name, collapsible.
      - Category rows: Position/Rotation/Scale per object, collapsible.
      - Track rows: X/Y/Z leaf tracks (derived from property strings like position.x, rotation.y, scale.z).
    - Left panel renders these rows with disclosure chevrons and indent; solo/mute/lock show only on leaf rows.
    - Right lanes:
      - For object and category rows: render “track marks” (small ticks) at the union of all child tracks’ key times; they’re visual only.
      - For leaf track rows: render key squares with drag-to-move and selection as before.
    - Kept header/ruler horizontally aligned with the list; kept scroll sync between the list and curve lanes.

Notes
- Group rows are visual aggregations; they don’t modify values themselves. Individual X/Y/Z tracks still edit and affect only their own property.
- Object/category rows can be expanded/collapsed independently.

Quality
- Typecheck: PASS for changed files.
- No behavior changes to sampling or persistence.

Want me to add quick add/remove keys on group rows or context menus for collapsing all/expanding all?