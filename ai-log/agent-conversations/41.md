# Quick horizontal refactoring and small fixes
Just as we successfully got shader editor(!!) working, i think it's again time to do a little bit of cleaning, as the AI agents have left quite a messy place!

## Prompt

Currently the Shader editor works, but needs a bit of polish and refactoring to make it robust.

Current Architecture:
 - A large panel that contains the whole shader material editor
 - Integration into the right inspector panel for materials
 - Utilities that transform our node definitions to real threejs webgpu TSL code
 - integration into the geometry store
Pain Points:
 - the buildTSLMaterialFactory is quite big already and will only get bigger with more tsl node support. It should be refactored into multiple smaller files (maybe per category?), the buildTSLMaterialFactory should just collect all smaller factories and merge it
 - The changes to the geometry store should be debounced or just actually commited if the values / position etc. of the nodes changes and rests (e.g. i think the drag input has a onValueCommit prop, and idk if react flow allows to listen to the end of drag)
 - There are quite a few inconsistencies that should be addressed:
  * the inspector has quick settings for things like roughness etc. These should actually change the values in the material unless it is connected via the shader editor
  * It is currently only possible to create standardnodematerials, but threejs/webgpu has many more node based materials
  * The UI in the inspector is overflowing with all the buttons and does not look minimalistic nor slim anymore. This is especially important since more stuff is coming, like type of material
- The shader editor should sit at the center of the viewport, but it's width should be smaller than the full size so it doesn't overlay the right and left panels (currently its impossible to edit materials in the right panel if shader editor is open)
- Shader editor can't be toggled via shortcut atm
Business Requirements:
- kebab-case for file names
- hierarchical and colocated folder structure, instead of dumping everything in a single folder
- components should have single responsibilities
- avoid using complex inline hooks in components
- hooks should be colocated in a hooks folder, naming them properly and making them maintainable
- prefer small files instead of monolithic large files
Technical Goals: improvements in maintainability
